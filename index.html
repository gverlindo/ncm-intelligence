
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Verlaz NCM Intelligence 2.0</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      color: #000;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      font-size: 28px;
      border-bottom: 2px solid #000;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    .filter-box {
      background: #fff;
      padding: 15px;
      border: 2px solid #000;
      border-radius: 8px;
      max-width: 800px;
      margin: 0 auto 20px auto;
    }
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
    }
    .form-group {
      flex: 1;
      min-width: 150px;
    }
    label {
      font-size: 13px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 8px;
      border: 2px solid #000;
      border-radius: 6px;
      background: #fff;
      color: #000;
      font-size: 14px;
    }
    button {
      padding: 8px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      margin: 5px;
      color: #fff;
    }
    .btn-import {
      background: #333;
    }
    .btn-export {
      background: #555;
    }
    .btn-action {
      background: #777;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #000;
      padding: 5px;
      text-align: center;
    }
    th {
      background: #000;
      color: #fff;
      cursor: pointer;
      position: relative;
    }
    th::after {
      content: " ‚áÖ";
      font-size: 10px;
      position: absolute;
      right: 5px;
    }
    canvas {
      margin-top: 15px;
      display: block;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    #loading {
      display: none;
      text-align: center;
      font-weight: bold;
      font-size: 22px;
      animation: blink 2.5s infinite;
    }
    #spinner {
      border: 4px solid #ccc;
      border-top: 4px solid #000;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      display: inline-block;
      vertical-align: middle;
      margin-right: 10px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
</head>
<body>
  <h1>Verlaz NCM Intelligence 2.0</h1>
  <div class="filter-box">
    <div class="form-row">
      <div class="form-group">
        <label for="ncm">C√≥digo NCM</label>
        <input type="text" id="ncm" placeholder="Ex: 3204.19.90">
      </div>
      <div class="form-group">
        <label for="ano">Ano</label>
        <input type="text" id="ano" placeholder="Ex: 2025">
      </div>
      <div class="form-group">
        <label for="mesInicial">M√™s Inicial</label>
        <select id="mesInicial">
          <option value="">Selecione</option>
          <option value="01">Janeiro</option>
          <option value="02">Fevereiro</option>
          <option value="03">Mar√ßo</option>
          <option value="04">Abril</option>
          <option value="05">Maio</option>
          <option value="06">Junho</option>
          <option value="07">Julho</option>
          <option value="08">Agosto</option>
          <option value="09">Setembro</option>
          <option value="10">Outubro</option>
          <option value="11">Novembro</option>
          <option value="12">Dezembro</option>
        </select>
      </div>
      <div class="form-group">
        <label for="mesFinal">M√™s Final</label>
        <select id="mesFinal">
          <option value="">Selecione</option>
          <option value="01">Janeiro</option>
          <option value="02">Fevereiro</option>
          <option value="03">Mar√ßo</option>
          <option value="04">Abril</option>
          <option value="05">Maio</option>
          <option value="06">Junho</option>
          <option value="07">Julho</option>
          <option value="08">Agosto</option>
          <option value="09">Setembro</option>
          <option value="10">Outubro</option>
          <option value="11">Novembro</option>
          <option value="12">Dezembro</option>
        </select>
      </div>
    </div>
    <div style="text-align:center; margin-top:10px;">
      <button class="btn-import" onclick="iniciarBusca('Importa√ß√£o')">Buscar Importa√ß√£o</button>
      <button class="btn-export" onclick="iniciarBusca('Exporta√ß√£o')">Buscar Exporta√ß√£o</button>
    </div>
  </div>

  <div id="loading">
    <div id="spinner"></div>
    <div id="loadingText"></div>
    <div style="font-size: 50px;">üöÄ</div>
  </div>

  <h3 id="descNcmResult" style="text-align:center; margin-top:20px;"></h3>

<p id="descTexto" style="text-align:center; font-weight:bold; margin-bottom:10px;"></p>
<div id="cardsResultado" style="display:none;">
  <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 30px;">
    <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; width: 300px;">
      <strong>DADOS DA PESQUISA</strong><br><br>
      <strong>NCM:</strong> <span id="ncm_card">-</span><br>
      <strong>Descri√ß√£o:</strong> Su√©teres, pul√¥veres, cardig√£s, coletes e artigos semelhantes, de malha, de fibras sint√©ticas ou artificiais<br>
      <strong>Per√≠odo Inicial:</strong> 01/2025<br>
      <strong>Per√≠odo Final:</strong> 06/2025<br>
      <strong>Unidade Medida:</strong> N√∫mero (Unidade)
    </div>

    <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; width: 250px;">
      <strong>TRATAMENTO TRIBUT√ÅRIO</strong>
      <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
        <tr><td style="border: 1px solid #ccc; padding: 5px;">II</td><td style="border: 1px solid #ccc; padding: 5px;">35%</td></tr>
        <tr><td style="border: 1px solid #ccc; padding: 5px;">IPI</td><td style="border: 1px solid #ccc; padding: 5px;">0%</td></tr>
        <tr><td style="border: 1px solid #ccc; padding: 5px;">PIS</td><td style="border: 1px solid #ccc; padding: 5px;">2,60%</td></tr>
        <tr><td style="border: 1px solid #ccc; padding: 5px;">COFINS</td><td style="border: 1px solid #ccc; padding: 5px;">9,65%</td></tr>
      </table>
    </div>

    <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; width: 250px;">
      <strong>TRATAMENTO ADMINISTRATIVO</strong>
      <ul style="margin-top: 10px;">
        <li>INMETRO</li>
        <li>MAPA</li>
        <li>DECEX</li>
        <li>ANVISA</li>
        <li>IBAMA</li>
      </ul>
    </div>
  </div>
</div>

  
<div id="verlazAviso" style="display:none; background-color:#c00; color:white; text-align:center;
padding:10px; font-size:16px; font-weight:bold; margin-top:20px; animation: blinkSlow 1.5s infinite;">
Verlaz buscar fornecedores em 1 clique. Clique no seu Pa√≠s de Interesse
</div>
<style>
@keyframes blinkSlow {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
</style>

<table id="resultado">
    <thead></thead>
    <tbody></tbody>
  </table>

  <canvas id="grafico"></canvas>
<canvas id="graficoFlutuacao" height="450" style="margin-top:30px; max-width:800px; display:block; margin-left:auto; margin-right:auto;"></canvas>


  <div style="text-align:center; margin-top:10px;">
    <button class="btn-action" onclick="salvarPDF()">Salvar em PDF</button>
    <button class="btn-action" onclick="location.reload()">Recome√ßar</button>
    <button class="btn-action" onclick="alert('Link gerado: relatorio_ncm.pdf')">Gerar Link Compartilhamento</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <script>
    function iniciarBusca(tipo) {
      const loading = document.getElementById("loading");
      const text = document.getElementById("loadingText");
      text.innerText = tipo === "Exporta√ß√£o" ? 
        "Buscando os pa√≠ses que mais compram do Brasil, volume exportado e pre√ßo unit√°rio m√©dio vendido." : 
        "Buscando os pa√≠ses que mais venderam para o Brasil, volume importado e pre√ßo unit√°rio m√©dio pago.";
      loading.style.display = "block";
      setTimeout(() => {
        loading.style.display = "none";
        buscar(tipo);
      }, 3500);
    }

    function buscar(tipo) {
      const ncm = document.getElementById("ncm").value || "";
      
  document.getElementById("descNcmResult").innerText = `Resultados para NCM ${ncm}`;
  document.getElementById("ncm_card").innerText = ncm;
  
document.getElementById("cardsResultado").style.display = tipo === "Importa√ß√£o" ? "block" : "none";
document.getElementById("verlazAviso").style.display = tipo === "Importa√ß√£o" ? "block" : "none";


      const table = document.getElementById("resultado");
      const thead = table.querySelector("thead");
      const tbody = table.querySelector("tbody");
      const ctx = document.getElementById("grafico").getContext("2d");
      tbody.innerHTML = "";
      thead.innerHTML = tipo === "Importa√ß√£o" ? `
        <tr>
          <th>Pa√≠s</th><th>FOB</th><th>CIF</th><th>Qtd</th><th>Un</th><th>Unit FOB</th><th>Unit CIF</th><th>FOB/Kg</th>
        </tr>` : `
        <tr>
          <th>Pa√≠s</th><th>FOB</th><th>Qtd</th><th>Un</th><th>Unit FOB</th>
        </tr>`;
      const dados = tipo === "Importa√ß√£o" ? [
        {pais:"China",fob:5000000,cif:5200000,qtd:10000,un:"TON"},
        {pais:"Espanha",fob:3000000,cif:3100000,qtd:7000,un:"TON"}
      ] : [
        {pais:"China",fob:4000000,qtd:9000,un:"TON"},
        {pais:"Espanha",fob:2500000,qtd:6000,un:"TON"}
      ];
      dados.forEach(d => {
        const query = encodeURIComponent(`fornecedores ${ncm} ${d.pais} site`);
        const link = `<a href="https://www.google.com/search?q=${query}" target="_blank">${d.pais}</a>`;
        const row = document.createElement("tr");
        row.innerHTML = tipo==="Importa√ß√£o"?
        `<td>${link}</td><td>${d.fob}</td><td>${d.cif}</td><td>${d.qtd}</td><td>${d.un}</td>
        <td>${(d.fob/d.qtd).toFixed(2)}</td><td>${(d.cif/d.qtd).toFixed(2)}</td><td>${(d.fob/(d.qtd*1000)).toFixed(2)}</td>`:
        `<td>${link}</td><td>${d.fob}</td><td>${d.qtd}</td><td>${d.un}</td><td>${(d.fob/d.qtd).toFixed(2)}</td>`;
        tbody.appendChild(row);
      });
      if(window.myChart){window.myChart.destroy();}
      window.myChart=new Chart(ctx,{type:"bar",data:{
        labels:dados.map(d=>d.pais),
        datasets:[{label:"Valor FOB (US$)",data:dados.map(d=>d.fob),backgroundColor:"#000"}]
      },options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}});
    }

    function salvarPDF() {
      html2pdf().from(document.body).save('relatorio_ncm.pdf');
    }
  </script>

<script>
function iniciarBusca(tipo) {
  const loading = document.getElementById("loading");
  const text = document.getElementById("loadingText");
  text.innerText = tipo === "Exporta√ß√£o"
    ? "Buscando os pa√≠ses que mais compram do Brasil, volume exportado e pre√ßo unit√°rio m√©dio vendido."
    : "Buscando os pa√≠ses que mais venderam para o Brasil, volume importado e pre√ßo unit√°rio m√©dio pago.";
  loading.style.display = "block";
  setTimeout(() => {
    loading.style.display = "none";
    buscar(tipo);
  }, 3500);
}

function buscar(tipo) {
  const ncm = document.getElementById("ncm").value || "";
  const descAPI = {
    "61103000": "Su√©teres, pul√¥veres e artigos semelhantes, de fibras sint√©ticas ou artificiais",
    "32041990": "Outros corantes org√¢nicos sint√©ticos"
  };
  const desc = descAPI[ncm] || "Descri√ß√£o n√£o encontrada";
  
  document.getElementById("descNcmResult").innerText = `Resultados para NCM ${ncm}`;
  document.getElementById("ncm_card").innerText = ncm;
  
document.getElementById("cardsResultado").style.display = tipo === "Importa√ß√£o" ? "block" : "none";
document.getElementById("verlazAviso").style.display = tipo === "Importa√ß√£o" ? "block" : "none";


  document.getElementById("descTexto").innerText = desc;

  const table = document.getElementById("resultado");
  const thead = table.querySelector("thead");
  const tbody = table.querySelector("tbody");
  const ctx = document.getElementById("grafico").getContext("2d");

  tbody.innerHTML = "";
  thead.innerHTML = tipo === "Importa√ß√£o" ? `
    <tr>
      <th>Pa√≠s</th><th>FOB</th><th>CIF</th><th>Qtd</th><th>Un</th><th>Unit FOB</th><th>Unit CIF</th><th>FOB/Kg</th>
    </tr>` : `
    <tr>
      <th>Pa√≠s</th><th>FOB</th><th>Qtd</th><th>Un</th><th>Unit FOB</th>
    </tr>`;

  const dados = tipo === "Importa√ß√£o" ? [
    {pais:"China",fob:5000000,cif:5200000,qtd:10000,un:"TON"},
    {pais:"Espanha",fob:3000000,cif:3100000,qtd:7000,un:"TON"}
  ] : [
    {pais:"China",fob:4000000,qtd:9000,un:"TON"},
    {pais:"Espanha",fob:2500000,qtd:6000,un:"TON"}
  ];

  dados.forEach(d => {
    const query = encodeURIComponent(`fornecedores ${ncm} ${d.pais} site`);
    const link = `<a href="https://www.google.com/search?q=${query}" target="_blank">${d.pais}</a>`;
    const row = document.createElement("tr");
    row.innerHTML = tipo === "Importa√ß√£o" ?
      `<td>${link}</td><td>${d.fob}</td><td>${d.cif}</td><td>${d.qtd}</td><td>${d.un}</td>
      <td>${(d.fob/d.qtd).toFixed(2)}</td><td>${(d.cif/d.qtd).toFixed(2)}</td><td>${(d.fob/(d.qtd*1000)).toFixed(2)}</td>` :
      `<td>${link}</td><td>${d.fob}</td><td>${d.qtd}</td><td>${d.un}</td><td>${(d.fob/d.qtd).toFixed(2)}</td>`;
    tbody.appendChild(row);
  });

  const headers = thead.querySelectorAll("th");
  let sortState = {};
  headers.forEach((header, index) => {
    sortState[index] = 'desc';
    header.onclick = () => {
      const rows = Array.from(tbody.querySelectorAll("tr"));
      const sorted = rows.sort((a, b) => {
        const aText = a.children[index].textContent.replace(/[^\d.-]/g, '');
        const bText = b.children[index].textContent.replace(/[^\d.-]/g, '');
        const dir = sortState[index] === 'asc' ? 1 : -1;
        return (parseFloat(aText) - parseFloat(bText)) * dir;
      });
      sortState[index] = sortState[index] === 'asc' ? 'desc' : 'asc';
      headers.forEach(h => h.innerText = h.innerText.replace(/[‚Üë‚Üì]/g, '‚áÖ'));
      header.innerText = header.innerText.replace('‚áÖ', sortState[index] === 'asc' ? ' ‚Üë' : ' ‚Üì');
      tbody.innerHTML = "";
      sorted.forEach(r => tbody.appendChild(r));
    };
  });

  if (window.myChart) {
    window.myChart.destroy();
  }
  window.myChart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: dados.map(d => d.pais),
      datasets: [{
        label: "Valor FOB (US$)",
        data: dados.map(d => d.fob),
        backgroundColor: "#000"
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true } }
    }
  });

  
  const ctxFlutuacao = document.getElementById("graficoFlutuacao").getContext("2d");
  if (window.myLineChart) { window.myLineChart.destroy(); }

  const gradientChina = ctxFlutuacao.createLinearGradient(0, 0, 0, 400);
  gradientChina.addColorStop(0, "rgba(255, 99, 132, 0.5)");
  gradientChina.addColorStop(1, "rgba(255, 99, 132, 0.1)");

  const gradientEspanha = ctxFlutuacao.createLinearGradient(0, 0, 0, 400);
  gradientEspanha.addColorStop(0, "rgba(54, 162, 235, 0.5)");
  gradientEspanha.addColorStop(1, "rgba(54, 162, 235, 0.1)");

  const gradientAlemanha = ctxFlutuacao.createLinearGradient(0, 0, 0, 400);
  gradientAlemanha.addColorStop(0, "rgba(75, 192, 192, 0.5)");
  gradientAlemanha.addColorStop(1, "rgba(75, 192, 192, 0.1)");

  window.myLineChart = new Chart(ctxFlutuacao, {
    type: "line",
    data: {
      labels: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun"],
      datasets: [
        {
          label: "China",
          data: [3.40, 3.50, 3.48, 3.60, 3.55, 3.52],
          borderColor: "rgba(255, 99, 132, 1)",
          backgroundColor: gradientChina,
          fill: true,
          tension: 0.4,
          pointRadius: 5,
          pointHoverRadius: 7
        },
        {
          label: "Espanha",
          data: [4.10, 4.20, 4.25, 4.30, 4.28, 4.22],
          borderColor: "rgba(54, 162, 235, 1)",
          backgroundColor: gradientEspanha,
          fill: true,
          tension: 0.4,
          pointRadius: 5,
          pointHoverRadius: 7
        },
        {
          label: "Alemanha",
          data: [5.00, 5.05, 5.10, 5.20, 5.18, 5.15],
          borderColor: "rgba(75, 192, 192, 1)",
          backgroundColor: gradientAlemanha,
          fill: true,
          tension: 0.4,
          pointRadius: 5,
          pointHoverRadius: 7
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: "bottom",
          labels: {
            font: {
              size: 14
            }
          }
        },
        title: {
          display: true,
          text: "Flutua√ß√£o do Pre√ßo Unit√°rio no Per√≠odo (US$)",
          font: {
            size: 20
          }
        },
        tooltip: {
          mode: 'index',
          intersect: false,
          padding: 10,
          bodyFont: { size: 14 },
          titleFont: { weight: 'bold' }
        }
      },
      interaction: {
        mode: 'nearest',
        axis: 'x',
        intersect: false
      },
      scales: {
        y: {
          beginAtZero: false,
          title: {
            display: true,
            text: 'US$ por Unidade'
          }
        },
        x: {
          title: {
            display: true,
            text: 'M√™s'
          }
        }
      }
    }
  });

  if (window.myLineChart) { window.myLineChart.destroy(); }
  window.myLineChart = new Chart(ctxFlutuacao, {
    type: "line",
    data: {
      labels: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun"],
      datasets: [
        {
          label: "China",
          data: [3.40, 3.50, 3.48, 3.60, 3.55, 3.52],
          borderColor: "red",
          fill: false,
          tension: 0.3
        },
        {
          label: "Espanha",
          data: [4.10, 4.20, 4.25, 4.30, 4.28, 4.22],
          borderColor: "blue",
          fill: false,
          tension: 0.3
        },
        {
          label: "Alemanha",
          data: [5.00, 5.05, 5.10, 5.20, 5.18, 5.15],
          borderColor: "green",
          fill: false,
          tension: 0.3
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: "top" },
        title: {
          display: true,
          text: "Flutua√ß√£o do Pre√ßo Unit√°rio no Per√≠odo (US$)"
        }
      },
      scales: {
        y: { beginAtZero: false }
      }
    }
  });

}

function salvarPDF() {
  html2pdf().from(document.body).save('relatorio_ncm.pdf');
}
</script>

<script>
function simularBuscaFornecedor(pais, ncm) {
  const overlay = document.createElement("div");
  overlay.id = "overlayBusca";
  overlay.style.position = "fixed";
  overlay.style.top = 0;
  overlay.style.left = 0;
  overlay.style.width = "100%";
  overlay.style.height = "100%";
  overlay.style.backgroundColor = "rgba(255, 255, 255, 0.95)";
  overlay.style.zIndex = 9999;
  overlay.style.display = "flex";
  overlay.style.flexDirection = "column";
  overlay.style.alignItems = "center";
  overlay.style.justifyContent = "center";
  overlay.innerHTML = `
    <img src="https://upload.wikimedia.org/wikipedia/commons/5/55/Rotating_earth_%28large%29.gif"
         style="width:180px; animation: blink 1s infinite;">
    <p style="font-size:22px; font-weight:bold; margin-top:20px;">Verlaz est√° buscando fornecedores...</p>
  `;
  document.body.appendChild(overlay);

  setTimeout(() => {
    overlay.remove();
    mostrarFornecedores(pais, ncm);
  }, 4000);
}

function mostrarFornecedores(pais, ncm) {
  const fornecedores = [
    { pais, nome:'Cavabianca', site:'https://www.cavabianca.com.ar/', whatsapp:'--', email:'info@cavabianca.com.ar' },
    { pais, nome:'Pistacuy', site:'https://www.pistacuy.com.ar/', whatsapp:'+54 11 5218‚Äë5656', email:'--' },
    { pais, nome:'Finca Richeze', site:'https://www.fincaricheze.com/', whatsapp:'+54 9 2645 20‚Äë7102', email:'info@fincaricheze.com' },
    { pais, nome:'Mel√≥ Agroindustrias', site:'https://meloagroindustrias.com/', whatsapp:'+54 264 425‚Äë0240', email:'--' }
  ];

  document.body.innerHTML = "";
  const section = document.createElement("section");

  const btn = document.createElement("button");
  btn.textContent = "‚Üê Voltar";
  btn.style = "margin: 20px; padding: 10px 15px; font-size: 14px; cursor: pointer;";
  btn.onclick = () => location.reload();
  section.appendChild(btn);

  const title = document.createElement("h2");
  title.textContent = `Fornecedores de ${ncm} na ${pais}`;
  title.style.textAlign = "center";
  section.appendChild(title);

  const wrapper = document.createElement("div");
  wrapper.style = "display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; padding: 20px;";

  fornecedores.forEach(f => {
    const card = document.createElement("div");
    card.style = "border: 1px solid #ccc; border-radius: 8px; padding: 15px; width: 260px; background: #fff;";
    card.innerHTML = `
      <h3>${f.nome}</h3>
      <p><strong>Pa√≠s:</strong> ${f.pais}</p>
      <p><strong>Site:</strong> <a href="${f.site}" target="_blank">${f.site}</a></p>
      <p><strong>WhatsApp:</strong> ${f.whatsapp}</p>
      <p><strong>Email:</strong> ${f.email}</p>
    `;
    wrapper.appendChild(card);
  });

  section.appendChild(wrapper);
  document.body.appendChild(section);

  const botoes = document.createElement("div");
  botoes.style = "text-align:center; margin-top:30px;";
  botoes.innerHTML = `
    <button onclick="location.reload()" style="padding:10px 15px; margin:10px; cursor:pointer;">‚Üê Voltar</button>
    <button onclick="alert('Um agente Verlaz entrar√° em contato com voc√™!')" style="padding:10px 15px; margin:10px; background-color:green; color:white; cursor:pointer;">Contratar um Agente Verlaz para me ajudar!</button>
  `;
  document.body.appendChild(botoes);

}

document.addEventListener("DOMContentLoaded", () => {
  let tipoAtual = "Importa√ß√£o";
  const tabela = document.getElementById("resultado");
  if (!tabela) return;

  // detecta o tipo de busca atual
  const btnImport = document.querySelector(".btn-import");
  btnImport.addEventListener("click", () => tipoAtual = "Importa√ß√£o");
  const btnExport = document.querySelector(".btn-export");
  btnExport.addEventListener("click", () => tipoAtual = "Exporta√ß√£o");

  tabela.addEventListener("click", e => {
    if (e.target.tagName === "A" && tipoAtual === "Importa√ß√£o") {
      e.preventDefault();
      const pais = e.target.textContent.trim();
      const ncm = document.getElementById("ncm")?.value || "Uvas Passas";
      simularBuscaFornecedor(pais, ncm);
    }
  });
});
</script>

<style>
@keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0;} }
</style>

</body>
</html>
